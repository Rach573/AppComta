{"version":3,"file":"main.cjs","sources":["../../src/shared/types/compta.ts","../../src/main/repository/ComptaStore.ts","../../src/main/repository/ComptaService.ts","../../src/main/repository/ComptaIpc.ts","../../src/main/RepositoryAll.ts","../../src/main/main.ts"],"sourcesContent":["export type ComptaCategory =\n  | 'frais_etablissement'\n  | 'actif_immobilise_brevet'\n  | 'actif_immobilise_equipement'\n  | 'actifs_circulants_creances'\n  | 'actifs_circulants_stock'\n  | 'actifs_circulants_cash'\n  | 'capitaux_propres_capital_initial'\n  | 'capitaux_propres_benefices_reportes'\n  | 'dette_long_terme_financiere'\n  | 'dette_court_terme_financiere'\n  | 'dette_court_terme_commerciale';\n\nexport type ComptaGroup = 'actif' | 'passif';\n\nexport interface ComptaEntry {\n  id: string;\n  label: string;\n  amount: number;\n  createdAt: string;\n  category: ComptaCategory;\n}\n\nexport interface BalanceSheetCategorySummary {\n  category: ComptaCategory;\n  label: string;\n  amount: number;\n}\n\nexport interface BalanceSheetSection {\n  group: ComptaGroup;\n  label: string;\n  total: number;\n  items: BalanceSheetCategorySummary[];\n}\n\nexport interface BalanceSheetSummary {\n  assets: BalanceSheetSection[];\n  liabilities: BalanceSheetSection[];\n  totalAssets: number;\n  totalLiabilities: number;\n}\n\nexport interface RegisterComptaPayload {\n  label: string;\n  amount: number;\n  category: ComptaCategory;\n}\n\nexport const COMPTA_CATEGORY_LABELS: Record<ComptaCategory, string> = {\n  frais_etablissement: \"Frais d'etablissement\",\n  actif_immobilise_brevet: 'Actifs immobilises - Brevet',\n  actif_immobilise_equipement: 'Actifs immobilises - Equipement',\n  actifs_circulants_creances: 'Actifs circulants - Creances',\n  actifs_circulants_stock: 'Actifs circulants - Stock',\n  actifs_circulants_cash: 'Actifs circulants - Cash',\n  capitaux_propres_capital_initial: 'Fonds propres - Capital initial',\n  capitaux_propres_benefices_reportes: 'Fonds propres - Benefices reportes',\n  dette_long_terme_financiere: 'Dettes > 1 an - Dettes financieres',\n  dette_court_terme_financiere: 'Dettes < 1 an - Dettes financieres',\n  dette_court_terme_commerciale: 'Dettes < 1 an - Dettes commerciales',\n};\n\nexport const COMPTA_CATEGORY_GROUP: Record<ComptaCategory, { group: ComptaGroup; section: string }> = {\n  frais_etablissement: { group: 'actif', section: 'Actif' },\n  actif_immobilise_brevet: { group: 'actif', section: 'Actifs immobilises' },\n  actif_immobilise_equipement: { group: 'actif', section: 'Actifs immobilises' },\n  actifs_circulants_creances: { group: 'actif', section: 'Actifs circulants' },\n  actifs_circulants_stock: { group: 'actif', section: 'Actifs circulants' },\n  actifs_circulants_cash: { group: 'actif', section: 'Actifs circulants' },\n  capitaux_propres_capital_initial: { group: 'passif', section: 'Fonds propres' },\n  capitaux_propres_benefices_reportes: { group: 'passif', section: 'Fonds propres' },\n  dette_long_terme_financiere: { group: 'passif', section: 'Dettes > 1 an' },\n  dette_court_terme_financiere: { group: 'passif', section: 'Dettes < 1 an' },\n  dette_court_terme_commerciale: { group: 'passif', section: 'Dettes < 1 an' },\n};\n","import { randomUUID } from 'node:crypto';\nimport type {\n  BalanceSheetSummary,\n  ComptaEntry,\n  RegisterComptaPayload,\n} from '@shared/types/compta';\nimport { COMPTA_CATEGORY_GROUP, COMPTA_CATEGORY_LABELS } from '@shared/types/compta';\n\nconst comptaStore: ComptaEntry[] = [\n  {\n    id: randomUUID(),\n    label: 'Achat materiel',\n    amount: 5000,\n    createdAt: new Date().toISOString(),\n    category: 'frais_etablissement',\n  },\n  {\n    id: randomUUID(),\n    label: 'Facture client',\n    amount: 70000,\n    createdAt: new Date().toISOString(),\n    category: 'actif_immobilise_equipement',\n  },\n  {\n    id: randomUUID(),\n    label: 'Capital initial',\n    amount: 60000,\n    createdAt: new Date().toISOString(),\n    category: 'capitaux_propres_capital_initial',\n  },\n  {\n    id: randomUUID(),\n    label: 'Benefice reporte',\n    amount: -2700,\n    createdAt: new Date().toISOString(),\n    category: 'capitaux_propres_benefices_reportes',\n  },\n  {\n    id: randomUUID(),\n    label: 'Stock marchandises',\n    amount: 15000,\n    createdAt: new Date().toISOString(),\n    category: 'actifs_circulants_stock',\n  },\n  {\n    id: randomUUID(),\n    label: 'Tresorerie',\n    amount: 7300,\n    createdAt: new Date().toISOString(),\n    category: 'actifs_circulants_cash',\n  },\n  {\n    id: randomUUID(),\n    label: 'Creances clients',\n    amount: 0,\n    createdAt: new Date().toISOString(),\n    category: 'actifs_circulants_creances',\n  },\n  {\n    id: randomUUID(),\n    label: 'Dettes financieres long terme',\n    amount: 50000,\n    createdAt: new Date().toISOString(),\n    category: 'dette_long_terme_financiere',\n  },\n];\n\nexport async function listComptaEntries(): Promise<ComptaEntry[]> {\n  return [...comptaStore].sort(\n    (a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime(),\n  );\n}\n\nexport async function insertComptaEntry(payload: RegisterComptaPayload): Promise<ComptaEntry> {\n  const entry: ComptaEntry = {\n    id: randomUUID(),\n    label: payload.label,\n    amount: payload.amount,\n    createdAt: new Date().toISOString(),\n    category: payload.category,\n  };\n  comptaStore.push(entry);\n  return entry;\n}\n\nexport async function removeComptaEntry(id: string): Promise<boolean> {\n  const index = comptaStore.findIndex((entry) => entry.id === id);\n  if (index === -1) {\n    return false;\n  }\n  comptaStore.splice(index, 1);\n  return true;\n}\n\nexport async function computeBalanceSheet(): Promise<BalanceSheetSummary> {\n  const sectionsMap: Record<\n    'actif' | 'passif',\n    Map<\n      string,\n      {\n        label: string;\n        items: Map<string, { category: ComptaEntry['category']; amount: number }>;\n        total: number;\n      }\n    >\n  > = {\n    actif: new Map(),\n    passif: new Map(),\n  };\n\n  const getSection = (group: 'actif' | 'passif', label: string) => {\n    let section = sectionsMap[group].get(label);\n    if (!section) {\n      section = { label, items: new Map(), total: 0 };\n      sectionsMap[group].set(label, section);\n    }\n    return section;\n  };\n\n  comptaStore.forEach((entry) => {\n    const meta = COMPTA_CATEGORY_GROUP[entry.category];\n    const section = getSection(meta.group, meta.section);\n    const key = entry.category;\n    const item = section.items.get(key);\n    if (item) {\n      item.amount += entry.amount;\n    } else {\n      section.items.set(key, { category: entry.category, amount: entry.amount });\n    }\n    section.total += entry.amount;\n  });\n\n  const buildSections = (group: 'actif' | 'passif') =>\n    Array.from(sectionsMap[group].values()).map((section) => ({\n      group,\n      label: section.label,\n      total: section.total,\n      items: Array.from(section.items.values()).map((item) => ({\n        category: item.category,\n        label: COMPTA_CATEGORY_LABELS[item.category],\n        amount: item.amount,\n      })),\n    }));\n\n  const assets = buildSections('actif');\n  const liabilities = buildSections('passif');\n\n  const totalAssets = assets.reduce((sum, section) => sum + section.total, 0);\n  const totalLiabilities = liabilities.reduce(\n    (sum, section) => sum + section.total,\n    0,\n  );\n\n  return {\n    assets,\n    liabilities,\n    totalAssets,\n    totalLiabilities,\n  };\n}\n","import type {\n  BalanceSheetSummary,\n  ComptaEntry,\n  RegisterComptaPayload,\n} from '@shared/types/compta';\nimport {\n  computeBalanceSheet,\n  insertComptaEntry,\n  listComptaEntries,\n  removeComptaEntry,\n} from './ComptaStore';\n\nexport async function getComptaEntries(): Promise<ComptaEntry[]> {\n  return listComptaEntries();\n}\n\nexport async function registerComptaEntry(\n  payload: RegisterComptaPayload,\n): Promise<ComptaEntry> {\n  return insertComptaEntry(payload);\n}\n\nexport async function deleteComptaEntry(id: string): Promise<boolean> {\n  return removeComptaEntry(id);\n}\n\nexport async function generateBalanceSheet(): Promise<BalanceSheetSummary> {\n  return computeBalanceSheet();\n}\n","import { ipcMain } from 'electron';\nimport type { RegisterComptaPayload } from '@shared/types/compta';\nimport {\n  generateBalanceSheet,\n  getComptaEntries,\n  registerComptaEntry,\n  deleteComptaEntry,\n} from './ComptaService';\n\nlet ipcRegistered = false;\n\nexport function registerComptaIpcHandlers(): void {\n  if (ipcRegistered) {\n    return;\n  }\n\n  ipcMain.handle('compta:list', async () => getComptaEntries());\n  ipcMain.handle(\n    'compta:register',\n    async (_event, payload: RegisterComptaPayload) => registerComptaEntry(payload),\n  );\n  ipcMain.handle('compta:delete', async (_event, id: string) => deleteComptaEntry(id));\n  ipcMain.handle('compta:balance', async () => generateBalanceSheet());\n\n  ipcRegistered = true;\n}\n","import { registerComptaIpcHandlers } from './repository/ComptaIpc';\n\nlet repositoriesRegistered = false;\n\nexport function registerRepositories(): void {\n  if (repositoriesRegistered) {\n    return;\n  }\n\n  registerComptaIpcHandlers();\n\n  repositoriesRegistered = true;\n}\n","import { app, BrowserWindow } from 'electron';\nimport path from 'node:path';\nimport { registerRepositories } from './RepositoryAll';\n\ndeclare const MAIN_WINDOW_VITE_DEV_SERVER_URL: string | undefined;\ndeclare const MAIN_WINDOW_VITE_NAME: string;\n\nconst createWindow = async () => {\n  const browserWindow = new BrowserWindow({\n    width: 1024,\n    height: 768,\n    autoHideMenuBar: true,\n    webPreferences: {\n      preload: path.join(__dirname, '../preload/preload.cjs'),\n      sandbox: false,\n      contextIsolation: true,\n    },\n  });\n\n  if (MAIN_WINDOW_VITE_DEV_SERVER_URL) {\n    await browserWindow.loadURL(MAIN_WINDOW_VITE_DEV_SERVER_URL);\n  } else {\n    await browserWindow.loadFile(\n      path.join(__dirname, '../renderer', MAIN_WINDOW_VITE_NAME, 'index.html'),\n    );\n  }\n};\n\napp.whenReady().then(() => {\n  registerRepositories();\n  return createWindow();\n});\n\napp.on('window-all-closed', () => {\n  if (process.platform !== 'darwin') {\n    app.quit();\n  }\n});\n\napp.on('activate', async () => {\n  if (BrowserWindow.getAllWindows().length === 0) {\n    await createWindow();\n  }\n});\n"],"names":["randomUUID","ipcMain","BrowserWindow","app"],"mappings":"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"}